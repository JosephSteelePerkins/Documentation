setTimeout(function(){ $('.fadeout').fadeOut('slow'); }, 4000);


// Wait until the DOM has loaded before querying the document
$(document).ready(function(){

	var num_decoration_clicks = 0;
	var decoration_clicks = [];

	var audio = document.getElementsByTagName("audio")[0];

	$('#decorations a').mouseenter(function() {
		//audio.play();
	});

	$('#decorations a').click(function(e) {

		e.preventDefault();
		number = $(this).data('num');
		decoration_clicks.push(number);
		num_decoration_clicks++;
		$(this).addClass('selected');

		if (num_decoration_clicks == 2) {

			correct = false;

			data = {};
			data['clicks'] = decoration_clicks;

			ajax_url = base_url() + 'inc/ajax.treasure_hunt_xmas_check.php';

			$.post(ajax_url, data, function(response) {
				console.log(response.status);

				// trigger fancybox
				if (response.status == 'correct') {
					$.fancybox({
						href: '#treasure_hunt_xmas_form'
					});
				} else {
					alert('Bad luck, that\'s incorrect, please try again.');
				}

				num_decoration_clicks = 0;
				decoration_clicks = [];
				$('#decorations a').removeClass('selected');
				
			});
			
		}

	});

	$('#treasure_hunt_xmas_form input.submit').click(function(e) {
		e.preventDefault();
	
		data = {};

		name = $('#treasure_hunt_name').val();
		email = $('#treasure_hunt_email').val();

		if (name.length == 0) {
			$('#treasure_hunt_name').focus();
			alert('Please provide your name');
			return false;
		}

		if (email.length == 0) {
			$('#treasure_hunt_email').focus();
			alert('Please provide your email address');
			return false;
		}

		data['name'] = name;
		data['email'] = email;

		ajax_url = base_url() + 'inc/ajax.treasure_hunt_xmas.php';

		$.post(ajax_url, data, function(response) {
			alert('Your details have been received - we\'ll be in touch soon');
			location.reload();
		});

	});

	$(".fancybox").fancybox({
		maxWidth	: 800,
		maxHeight	: 600,
		fitToView	: false,
		width		: '70%',
		height		: '70%',
		autoSize	: false,
		closeClick	: false,
		openEffect	: 'none',
		closeEffect	: 'none'
	});

	$('#subscribe_form').validate();

	$('ul.tabs').each(function(){
		// For each set of tabs, we want to keep track of
		// which tab is active and it's associated content
		var $active, $content, $links = $(this).find('a');

		// If the location.hash matches one of the links, use that as the active tab.
		// If no match is found, use the first link as the initial active tab.
		$active = $($links.filter('[href="'+location.hash+'"]')[0] || $links[0]);
		$active.addClass('active');

		$content = $($active[0].hash);

		// Hide the remaining content
		$links.not($active).each(function () {
			$(this.hash).hide();
		});

		// Bind the click event handler
		$(this).on('click', 'a', function(e){
			// Make the old tab inactive.
			$active.removeClass('active');
			$content.hide();

			// Update the variables with the new link and content
			$active = $(this);
			$content = $(this.hash);

			// Make the tab active.
			$active.addClass('active');
			$content.show();

			// Prevent the anchor's default click action
			e.preventDefault();
		});
	});


	$("#latest_vacancies_scroll").simplyScroll({

		'orientation' : 'vertical',
		'customClass' : 'vert'

	});
	
	$('#subscribe_submit').click(function() {
	
		email = $('#subscribe_email').val();
		if (email.length == 0) {
			alert('Please enter your email address');
			$('#subscribe_email').focus();
			return false;
		}
		
		ajax_url = base_url() + 'inc/ajax.subscribe.php';
		
		post_data = { 'email' : email };
    		
		$.post(ajax_url, post_data, function(returned_data) {
			
			//$('#subscribe_message').html(returned_data);
			
			alert('Thank you for subscribing to our job alerts');
			
			$('#subscribe_email').val('');
			
		});
	
	});
	
	/*
	$('#subscribe_email').focus(function() {
		$('#subscribe_message').fadeOut();
	});
	*/
	
});